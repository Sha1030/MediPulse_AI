{"ast":null,"code":"import _objectSpread from\"A:/Hackathon/ByteQuest/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{io}from'socket.io-client';import axios from'axios';import{useAuth}from'../contexts/AuthContext';import OverviewTab from'./dashboard/OverviewTab';import AlertsTab from'./dashboard/AlertsTab';import ScheduleTab from'./dashboard/ScheduleTab';import AdminPanelTab from'./dashboard/AdminPanelTab';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Dashboard(){const{user,logout}=useAuth();const navigate=useNavigate();const[activeTab,setActiveTab]=useState('overview');const[alerts,setAlerts]=useState([]);const[schedules,setSchedules]=useState([]);useEffect(()=>{if(!(user!==null&&user!==void 0&&user.id))return;// Connect to Socket.IO\nconst newSocket=io('http://localhost:3002');// Join user room for alerts\nnewSocket.emit('join-alerts',user.id);// Listen for new alerts\nnewSocket.on('new-alert',alert=>{setAlerts(prev=>[alert,...prev]);});// Load initial data\nloadAlerts();loadSchedules();return()=>newSocket.close();},[user===null||user===void 0?void 0:user.id]);const loadAlerts=async()=>{try{const response=await axios.get('/api/alerts');setAlerts(response.data);}catch(error){console.error('Error loading alerts:',error);setAlerts([]);}};const loadSchedules=async()=>{try{const response=await axios.get('/api/schedules');setSchedules(response.data);}catch(error){console.error('Error loading schedules:',error);setSchedules([]);}};const acknowledgeAlert=async alertId=>{try{await axios.put(\"/api/alerts/\".concat(alertId,\"/acknowledge\"));setAlerts(prev=>prev.map(alert=>alert._id===alertId?_objectSpread(_objectSpread({},alert),{},{acknowledgedBy:[...alert.acknowledgedBy,{userId:user.id}]}):alert));}catch(error){console.error('Error acknowledging alert:',error);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"dashboard-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Hospital Emergency Intelligence\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-info\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Welcome, \",user.name,\" (\",user.role,\")\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"header-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/profile'),className:\"nav-link-btn\",children:\"Profile\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/settings'),className:\"nav-link-btn\",children:\"Settings\"}),/*#__PURE__*/_jsx(\"button\",{onClick:logout,className:\"logout-btn\",children:\"Logout\"})]})]})]}),/*#__PURE__*/_jsxs(\"nav\",{className:\"dashboard-nav\",children:[/*#__PURE__*/_jsx(\"button\",{className:activeTab==='overview'?'nav-btn active':'nav-btn',onClick:()=>setActiveTab('overview'),children:\"Overview\"}),/*#__PURE__*/_jsxs(\"button\",{className:activeTab==='alerts'?'nav-btn active':'nav-btn',onClick:()=>setActiveTab('alerts'),children:[\"Alerts \",alerts.filter(a=>a.status==='active').length>0&&\"(\".concat(alerts.filter(a=>a.status==='active').length,\")\")]}),/*#__PURE__*/_jsx(\"button\",{className:activeTab==='schedule'?'nav-btn active':'nav-btn',onClick:()=>setActiveTab('schedule'),children:\"My Schedule\"}),user.role==='admin'&&/*#__PURE__*/_jsx(\"button\",{className:activeTab==='admin'?'nav-btn active':'nav-btn',onClick:()=>setActiveTab('admin'),children:\"Admin Panel\"})]}),/*#__PURE__*/_jsxs(\"main\",{className:\"dashboard-content\",children:[activeTab==='overview'&&/*#__PURE__*/_jsx(OverviewTab,{user:user}),activeTab==='alerts'&&/*#__PURE__*/_jsx(AlertsTab,{alerts:alerts,onAcknowledge:acknowledgeAlert,user:user}),activeTab==='schedule'&&/*#__PURE__*/_jsx(ScheduleTab,{schedules:schedules}),activeTab==='admin'&&user.role==='admin'&&/*#__PURE__*/_jsx(AdminPanelTab,{})]})]});}export default Dashboard;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","io","axios","useAuth","OverviewTab","AlertsTab","ScheduleTab","AdminPanelTab","jsx","_jsx","jsxs","_jsxs","Dashboard","user","logout","navigate","activeTab","setActiveTab","alerts","setAlerts","schedules","setSchedules","id","newSocket","emit","on","alert","prev","loadAlerts","loadSchedules","close","response","get","data","error","console","acknowledgeAlert","alertId","put","concat","map","_id","_objectSpread","acknowledgedBy","userId","className","children","name","role","onClick","filter","a","status","length","onAcknowledge"],"sources":["A:/Hackathon/ByteQuest/frontend/src/components/Dashboard.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { io } from 'socket.io-client';\r\nimport axios from 'axios';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport OverviewTab from './dashboard/OverviewTab';\r\nimport AlertsTab from './dashboard/AlertsTab';\r\nimport ScheduleTab from './dashboard/ScheduleTab';\r\nimport AdminPanelTab from './dashboard/AdminPanelTab';\r\n\r\nfunction Dashboard() {\r\n  const { user, logout } = useAuth();\r\n  const navigate = useNavigate();\r\n  const [activeTab, setActiveTab] = useState('overview');\r\n  const [alerts, setAlerts] = useState([]);\r\n  const [schedules, setSchedules] = useState([]);\r\n\r\n  useEffect(() => {\r\n    if (!user?.id) return;\r\n\r\n    // Connect to Socket.IO\r\n    const newSocket = io('http://localhost:3002');\r\n\r\n    // Join user room for alerts\r\n    newSocket.emit('join-alerts', user.id);\r\n\r\n    // Listen for new alerts\r\n    newSocket.on('new-alert', (alert) => {\r\n      setAlerts(prev => [alert, ...prev]);\r\n    });\r\n\r\n    // Load initial data\r\n    loadAlerts();\r\n    loadSchedules();\r\n\r\n    return () => newSocket.close();\r\n  }, [user?.id]);\r\n\r\n  const loadAlerts = async () => {\r\n    try {\r\n      const response = await axios.get('/api/alerts');\r\n      setAlerts(response.data);\r\n    } catch (error) {\r\n      console.error('Error loading alerts:', error);\r\n      setAlerts([]);\r\n    }\r\n  };\r\n\r\n  const loadSchedules = async () => {\r\n    try {\r\n      const response = await axios.get('/api/schedules');\r\n      setSchedules(response.data);\r\n    } catch (error) {\r\n      console.error('Error loading schedules:', error);\r\n      setSchedules([]);\r\n    }\r\n  };\r\n\r\n  const acknowledgeAlert = async (alertId) => {\r\n    try {\r\n      await axios.put(`/api/alerts/${alertId}/acknowledge`);\r\n      setAlerts(prev => prev.map(alert =>\r\n        alert._id === alertId\r\n          ? { ...alert, acknowledgedBy: [...alert.acknowledgedBy, { userId: user.id }] }\r\n          : alert\r\n      ));\r\n    } catch (error) {\r\n      console.error('Error acknowledging alert:', error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"dashboard\">\r\n      <header className=\"dashboard-header\">\r\n        <h1>Hospital Emergency Intelligence</h1>\r\n        <div className=\"user-info\">\r\n          <span>Welcome, {user.name} ({user.role})</span>\r\n          <div className=\"header-actions\">\r\n            <button onClick={() => navigate('/profile')} className=\"nav-link-btn\">Profile</button>\r\n            <button onClick={() => navigate('/settings')} className=\"nav-link-btn\">Settings</button>\r\n            <button onClick={logout} className=\"logout-btn\">Logout</button>\r\n          </div>\r\n        </div>\r\n      </header>\r\n\r\n      <nav className=\"dashboard-nav\">\r\n        <button\r\n          className={activeTab === 'overview' ? 'nav-btn active' : 'nav-btn'}\r\n          onClick={() => setActiveTab('overview')}\r\n        >\r\n          Overview\r\n        </button>\r\n        <button\r\n          className={activeTab === 'alerts' ? 'nav-btn active' : 'nav-btn'}\r\n          onClick={() => setActiveTab('alerts')}\r\n        >\r\n          Alerts {alerts.filter(a => a.status === 'active').length > 0 && `(${alerts.filter(a => a.status === 'active').length})`}\r\n        </button>\r\n        <button\r\n          className={activeTab === 'schedule' ? 'nav-btn active' : 'nav-btn'}\r\n          onClick={() => setActiveTab('schedule')}\r\n        >\r\n          My Schedule\r\n        </button>\r\n        {user.role === 'admin' && (\r\n          <button\r\n            className={activeTab === 'admin' ? 'nav-btn active' : 'nav-btn'}\r\n            onClick={() => setActiveTab('admin')}\r\n          >\r\n            Admin Panel\r\n          </button>\r\n        )}\r\n      </nav>\r\n\r\n      <main className=\"dashboard-content\">\r\n        {activeTab === 'overview' && <OverviewTab user={user} />}\r\n        {activeTab === 'alerts' && (\r\n          <AlertsTab\r\n            alerts={alerts}\r\n            onAcknowledge={acknowledgeAlert}\r\n            user={user}\r\n          />\r\n        )}\r\n        {activeTab === 'schedule' && <ScheduleTab schedules={schedules} />}\r\n        {activeTab === 'admin' && user.role === 'admin' && <AdminPanelTab />}\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Dashboard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}